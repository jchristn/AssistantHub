# Wait State Label Feature Plan

## Overview

Add a randomized, playful text label next to the typing indicator dots in the chat panel. The label appears when the user sends a message and disappears when the first token arrives from the model. This gives the chat personality and briefly distracts the user during the wait for inference.

---

## Checklist

> Mark items: `[ ]` = pending, `[x]` = done, `[~]` = in progress, `[-]` = skipped

### 1. Wait State Messages Array — `ChatPanel.jsx`

- [x] **1.1** Add a `WAIT_MESSAGES` constant array (201 strings) at the top of `ChatPanel.jsx` (see Appendix A for the approved messages)
- [x] **1.2** Add a `pickWaitMessage` function that selects a random entry while avoiding the last 20 used messages within the chat session. Uses a `useRef` to track recent history:
  ```js
  const recentWaitMessages = useRef([]);

  function pickWaitMessage() {
    const available = WAIT_MESSAGES.filter(m => !recentWaitMessages.current.includes(m));
    const pool = available.length > 0 ? available : WAIT_MESSAGES;
    const picked = pool[Math.floor(Math.random() * pool.length)];
    recentWaitMessages.current.push(picked);
    if (recentWaitMessages.current.length > 20) recentWaitMessages.current.shift();
    return picked;
  }
  ```

### 2. State Management — `ChatPanel.jsx`

- [x] **2.1** Add a `waitMessage` state variable: `const [waitMessage, setWaitMessage] = useState('');`
- [x] **2.2** Add a `recentWaitMessages` ref: `const recentWaitMessages = useRef([]);`
- [x] **2.3** In the send handler, when `setLoading(true)` is called, also call `setWaitMessage(pickWaitMessage())` to pick a new non-repeating message each time the user sends
- [x] **2.4** The label automatically disappears because the typing indicator's render condition (`loading && !compacting && !messages.some(m => m.isStreaming)`) already becomes false when the first token arrives — no additional cleanup needed

### 3. Render — `ChatPanel.jsx`

- [x] **3.1** Modify the typing indicator block (lines 726-743) to include the wait message label next to the dots:
  ```jsx
  {loading && !compacting && !messages.some(m => m.isStreaming) && (
    <div className="chat-message-row assistant">
      <div className="chat-avatar assistant-avatar">
        <img src={logoSrc} alt="" onError={(e) => { e.target.src = '/logo-new.png'; }} />
      </div>
      <div className="chat-message-content-wrap">
        <div className="chat-bubble assistant">
          <div className="chat-typing-indicator">
            <span></span><span></span><span></span>
            <span className="chat-wait-label">{waitMessage}</span>
          </div>
        </div>
      </div>
    </div>
  )}
  ```

### 4. CSS — `App.css`

- [x] **4.1** Add styling for `.chat-wait-label` near the existing `.chat-typing-indicator` styles (around line 1243):
  ```css
  .chat-wait-label {
    margin-left: 8px;
    font-size: 0.8rem;
    color: var(--text-secondary);
    opacity: 0.7;
    font-style: italic;
    animation: chat-wait-fade-in 0.5s ease-in;
    white-space: nowrap;
  }

  @keyframes chat-wait-fade-in {
    from { opacity: 0; }
    to { opacity: 0.7; }
  }
  ```

---

## Behavior Summary

```
User sends message
    |
setLoading(true), setWaitMessage(pickWaitMessage())
    |
Typing dots + "Scouring the interwebs..." displayed
    |
First SSE delta arrives → isStreaming = true
    |
Typing indicator condition becomes false → dots + label disappear
    |
Streamed response renders in place
```

---

## Files Modified

| File | Change |
|------|--------|
| `dashboard/src/components/ChatPanel.jsx` | Add `WAIT_MESSAGES` array, `pickWaitMessage()`, `waitMessage` state, render label |
| `dashboard/src/App.css` | Add `.chat-wait-label` and fade-in animation |

---

## Appendix A — Proposed Wait Messages (100)

> Review and edit as desired. These should be short, fun, and non-distracting.

```
1.  Scanning available sources...
2.  Searching all the things...
3.  Consulting the oracle...
4.  Asking the hive mind...
5.  Rummaging through the archives...
6.  Dusting off the encyclopedia...
7.  Putting on my thinking cap...
8.  Crunching the numbers...
9.  Reading between the lines...
10. Diving into the deep end...
11. Connecting the dots...
12. Spinning up the hamster wheel...
13. Warming up the neurons...
14. Poking the knowledge base...
15. Doing a quick Snoopy dance...
16. Translating from robot to human...
17. Assembling the brain trust...
18. Percolating some thoughts...
19. Mining for gold nuggets...
20. Untangling the web of knowledge...
21. Firing up the think tank...
22. Channeling my inner librarian...
23. Shuffling through the card catalog...
24. Brewing a fresh pot of answers...
25. Loading infinite wisdom...
26. Calibrating the answer engine...
27. Tuning into the right frequency...
28. Decoding the matrix...
29. Phoning a friend...
30. Checking under every rock...
31. Flipping through the pages...
32. Cross-referencing the universe...
33. Letting the gears turn...
34. Interrogating the database...
35. Shaking the magic 8-ball...
36. Feeding the thinking machine...
37. Scanning the horizon...
38. Chasing down a lead...
39. Following the breadcrumbs...
40. Piecing together the puzzle...
41. Running the numbers...
42. Consulting the archives...
43. Sifting through the data...
44. Waking up the brain cells...
45. Charging the flux capacitor...
46. Engaging warp drive...
47. Booting up the answer module...
48. Querying the mothership...
49. Phoning a friend...
50. Processing at light speed...
51. Herding the relevant bits...
52. Compiling a brilliant response...
53. Fetching something clever...
54. Reaching into the knowledge vault...
55. Unraveling the mystery...
56. Sorting through the haystack...
57. Picking the brain trust...
58. Doing some heavy lifting...
59. Stretching the neural networks...
60. Excavating the answer mine...
61. Plucking from the wisdom tree...
62. Negotiating with the algorithms...
63. Winding up the clockwork...
64. Tapping into the mainframe...
65. Downloading enlightenment...
66. Hunting for the good stuff...
67. Marinating on that one...
68. Rolling up my sleeves...
69. Taking the scenic route through the data...
70. Asking the rubber duck...
71. Revving up the inference engine...
72. Warming up the word generator...
73. Sharpening the pencils...
74. Composing a masterpiece...
75. Loading the knowledge cannons...
76. Tuning the signal...
77. Riffling through the filing cabinet...
78. Summoning the muse...
79. Thinking really, really hard...
80. Pondering the imponderables...
81. Tickling the transistors...
82. Unleashing the research bots...
83. Navigating the info superhighway...
84. Letting it simmer...
85. Putting the pieces together...
86. Combing through the details...
87. Rustling up an answer...
88. Giving it the old college try...
89. Reviewing all the things...
90. Trawling the knowledge ocean...
91. Doing a deep dive...
92. Wrangling the data gremlins...
93. Cranking the idea generator...
94. Running it through the think-o-matic...
95. Chewing on that thought...
96. Queuing up something good...
97. Assembling the response squad...
98. Digging through the treasure chest...
99. Mapping the answer landscape...
100. Triple-checking the double-checked coordinates...
101. Thinking through that...
102. Reviewing relevant context...
103. Pulling in what matters...
104. Aligning the signals...
105. Organizing the pieces...
106. Evaluating possibilities...
107. Structuring a clear answer...
108. Sorting signal from noise...
109. Narrowing it down...
110. Framing the response...
111. Refining the details...
112. Weighing the options...
113. Checking internal consistency...
114. Matching patterns...
115. Looking at it from a few angles...
116. Filtering the essentials...
117. Drafting something helpful...
118. Cross-checking assumptions...
119. Calibrating the reply...
120. Consolidating insights...
121. Synthesizing information...
122. Lining up the facts...
123. Reviewing prior context...
124. Selecting the strongest signal...
125. Building the outline...
126. Arranging the logic...
127. Verifying the flow...
128. Polishing clarity...
129. Reducing ambiguity...
130. Filling in the gaps...
131. Stress-testing the reasoning...
132. Clarifying the structure...
133. Evaluating tradeoffs...
134. Checking edge cases...
135. Testing for completeness...
136. Ensuring coherence...
137. Connecting relevant ideas...
138. Drafting carefully...
139. Balancing precision and clarity...
140. Optimizing for usefulness...
141. Mapping dependencies...
142. Examining implications...
143. Tightening the explanation...
144. Adjusting for context...
145. Reviewing constraints...
146. Harmonizing the components...
147. Making it concise...
148. Expanding where needed...
149. Trimming the excess...
150. Validating the approach...
151. Rechecking assumptions...
152. Improving readability...
153. Strengthening the argument...
154. Clarifying intent...
155. Preparing a thoughtful answer...
156. Evaluating supporting details...
157. Checking for gaps...
158. Aligning with your question...
159. Confirming relevance...
160. Focusing the response...
161. Resolving ambiguities...
162. Structuring the output...
163. Weaving it together...
164. Shaping the explanation...
165. Refining the tone...
166. Validating logic paths...
167. Looking for blind spots...
168. Checking consistency...
169. Preparing something solid...
170. Finalizing the structure...
171. Drafting with care...
172. Making it actionable...
173. Enhancing clarity...
174. Organizing key points...
175. Reviewing dependencies...
176. Checking assumptions twice...
177. Connecting related threads...
178. Sharpening the conclusion...
179. Smoothing the transitions...
180. Aligning the reasoning...
181. Balancing depth and brevity...
182. Re-evaluating context...
183. Prioritizing what matters...
184. Distilling the essentials...
185. Stress-testing the logic...
186. Validating the reasoning chain...
187. Ensuring alignment...
188. Clarifying the answer path...
189. Drafting the response...
190. Tightening up the logic...
191. Reviewing implications...
192. Clarifying tradeoffs...
193. Checking constraints...
194. Reviewing the signal strength...
195. Refining the approach...
196. Ensuring usefulness...
197. Organizing insights...
198. Final pass underway...
199. Wrapping it together...
200. Almost ready...
201. Getting there...
```
